---
title: "ISL - Chapter 3 Exercises"
author: "Momoko Price"
date: "18/04/2020"
output: 
  html_document:
    css: rmd_report.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# global options
options(stringsAsFactors = F)
# Load libraries
require(tidyverse)
require(data.table)
require(ggplot2)
require(ISLR)
require(MASS)
require(gridExtra)
require(PerformanceAnalytics)
```

8. This question involves the use of simple linear regression on the Auto data set.

```{r q8_pre_data, include=FALSE}
# Load data
file <- "Auto.csv"
data <- read.csv(file)

# 1: check obj structure, change int to factors

data <- data %>%
  mutate_if(is.integer, as.factor) %>%
  mutate_if(is.character, as.factor)
str(data) # check if organization makes sense

# Adjust as needed: 

# horsepower -> change to numeric
data$horsepower <- as.numeric(data$horsepower)

# weight -> change to numeric
data$weight <- as.numeric(data$weight)

# name -> change to character
data$name <- as.character(data$name)

# check again
str(data)

```

(a) Use the lm() function to perform a simple linear regression with mpg as the response and horsepower as the predictor. Use the summary() function to print the results. Comment on the output. 

* *First, is there a relationship between the predictor and the response?*
  
```{r q8_step_1, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
lm.fit1 <- lm(mpg ~ horsepower, data)
summary(lm.fit1)
```
  
* *First, is there a relationship between the predictor and the response?*

  * ii. How strong is the relationship between the predictor and the response?
  * iii. Is the relationship between the predictor and the response positive or negative?
  * iv. What is the predicted mpg associated with a horsepower of 98? What are the associated 95 % confidence and prediction intervals?

* (b) Plot the response and the predictor. Use the abline() function to display the least squares regression line.

* (c) Use the plot() function to produce diagnostic plots of the least squares regression fit. Comment on any problems you see with the fit



